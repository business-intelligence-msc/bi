 <!DOCTYPE html>
 <html>
   <head>

     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">

     

     <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.css" type="text/css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" rel="stylesheet" />

     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.address/1.6/jquery.address.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.10/semantic.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
     <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>
     <script>hljs.initHighlightingOnLoad();</script>

     

     <style>
       

body 
{
  font-family: "Open Sans", "Helvetica", "Helvetica Neue",  "Arial", sans-serif;
}

figcaption
{
  margin-bottom: 20px;
}

.vertical-align
{
  display: flex;
  align-items: center;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



     </style>

   </head>

  <body>
    

<style>
  

code
{
  font-family: "Monaco";
  font-size: 110%;
}

img
{
  padding:1px;
  border:1px solid black;
}

h1
{
  font-style:italic;
  font-size:130%;
  border-bottom:thin solid black;
}

h2
{
  font-size:110%;
  border-bottom: thin solid black;
}

h3
{
  font-size:100%;
  border-bottom: thin solid black;
}

body
{
  overflow-y: scroll;
}

.pushable > .pusher
{
  padding-bottom: 1.5rem;
}

.ui.segment.pushable
{
  margin: 0;
  padding: 1rem 0;
  overflow: visible;
}



</style>

<div class="ui fixed top pointing inverted stackable menu labmenu">
  <header class="header item">
    <i id="toc" class="sitemap icon"></i>
    <a href="../index.html">
      Future Trends and Privacy in BI
    </a>
  </header>
  <div class="right tab-menu menu">
    
    <a class="item" data-tab="Lab-10">
      Lab-10
    </a>
    
    <a class="item" data-tab="01">
      01
    </a>
    
    <a class="item" data-tab="02">
      02
    </a>
    
    <a class="item" data-tab="03">
      03
    </a>
    
    <a class="item" data-tab="04">
      04
    </a>
    
    <div class="item">
      
    </div>
  </div>
</div>

<div class="ui segment pushable">
  <div class="ui inverted labeled icon left inline vertical sidebar menu">
    
      
        <a class="item" href="../../topic-01-Introduction/book-00-Qlik/index.html">
          Lab-01
        </a>
      
    
      
        <a class="item" href="../../topic-02-Org-Memory/book/index.html">
          Lab-02
        </a>
      
    
      
        <a class="item" href="../../topic-02-Org-Memory/book-b/index.html">
          Lab-03
        </a>
      
    
      
        <a class="item" href="../../topic-02-Org-Memory/book-c/index.html">
          Lab-04
        </a>
      
    
      
        <a class="item" href="../../topic-03-Info-Integration/book/index.html">
          Lab-05
        </a>
      
    
      
        <a class="item" href="../../topic-03-Info-Integration/book-a/index.html">
          Lab-06
        </a>
      
    
      
        <a class="item" href="../../topic-04-Info-Insights/book/index.html">
          Lab-07
        </a>
      
    
      
        <a class="item" href="../../topic-04-Info-Insights/book-b/index.html">
          Lab-08
        </a>
      
    
      
        <a class="item" href="../../topic-05-Info-Presentation/book/index.html">
          Lab-09
        </a>
      
    
      
        <a class="item" href="../../topic-06-ManagingBI-Future/book/index.html">
          Lab-10
        </a>
      
    
  </div>
  <div class="pusher" tabindex="-1">
    <div class="ui basic segment" id="labchat">
      <br>
      
      <div  class="ui tab segment lab" data-tab="Lab-10">
        <h1>Objectives</h1>
<p>In this lab you work on advanced interface design.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="01">
        <h1>Advanced Interface Design</h1>
<h2>Expressions</h2>
<p>Expressions are by no means limited to chart expressions and sort expressions. Other uses of expressions are as label expressions, conditional functions, dynamic text in text objects, chart attribute functions, or colour functions. Wherever there is an ellipsis (...) an expression can be used. Keep in mind that in contrast to chart expressions, calculated formulas must be preceded by an equal sign (=).</p>
<p>Where you can enter a label text you can enter a label expression. Using expressions enables the additional functionality of displaying dynamic text, that is, text that changes according to the current logical state of hte application.</p>
<p>Sometimes numbers say more than visual charts. The dashboard users require a rapid overview over the company&#39;s performance, such as CYTD Sales compared to LYTD Sales, and if the Margin reaches the 15% target. The dashboard is the given home for showing those types of high-level KPIs.</p>
<h2>Create KPI text boxes</h2>
<p>The CEO requires a rapid overview of the company&#39;s performance, such as the KPIs for Slaes, Margn%, and Orders.</p>
<ul>
<li>On the Dashboard sheet, right click the margin gauge and go to properties, select presentation, clear show scale, select the text in the chart that shows the Margin% and click Delete.</li>
<li>Define segment 1 as low bound 0.0 with the colour red.</li>
<li>Define semgent 2 as low bound 0.1 with the colour yellow.</li>
<li>Change the indicator to Fill to value and place a border of 1 around the guage.</li>
<li>On the general tab, clear Show Title in Chart.</li>
<li>On the layout tab, set border width to 0pt. click ok.</li>
<li>Create a new sheet object, Text Object.</li>
<li>In the general properties, foreground, text, type =&#39;Sales&#39; &amp; Num(sum(LineSalesAmount), &#39;$#,##0&#39;)</li>
<li>under background, set the transparency slider to 100%.</li>
<li>In the general properties, under layout, set the horizontal alignment to Left and the vertical alignment to top.</li>
<li>Click font, select Ariel, bold, size 16.</li>
<li>Select the layout tab, and set the border width to 0pt. click ok</li>
<li>Create a copy of the Sales KPI, set the text to =&#39;Margin%:&#39; &amp; Num(Sum(Margin)/Sum(LineSalesAmount),&#39;#,##0%&#39;). click ok</li>
<li>Arrange the objects as shown.</li>
</ul>
<p><img src="./img/12.png" alt=""></p>
<ul>
<li>Modify the Sales KPI text object, go to the properties and type =&#39;Sales CYTD: &#39; &amp; num(Sum(LineSalesAmount * CYTDFlag), &#39;$#,##0&#39;) click ok</li>
<li>Modify the Margin KPI text object, =&#39;Margin% CYTD: &#39; &amp; num(Sum(Margin <em> CYTDFlag)/Sum(LineSalesAmount </em> CYTDFlag), &#39;#,##0%&#39;)</li>
<li>Modify the Margin KPI guage expression to be Sum(Margin <em> CYTDFlag)/Sum(LineSalesAmount </em> CYTDFlag)</li>
<li>Modify the Orders KPI text object, =&#39;Orders CYTD: &#39; &amp; num(Count(DISTINCT OrderID *CYTDFlag), &#39;#,##0&#39;)</li>
</ul>
<p><img src="./img/13.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="02">
        <h1>Conditional show on a button</h1>
<p>You may want to provide a navigation element that leads the user when only one customer is selected form the Customer Details table ot the order details sheet.</p>
<p>You need the sheet ID of the Order Details sheet to start.</p>
<ul>
<li>On the order details sheet, right click and on the general tab in properties copy the sheet id.</li>
<li>Select the customer details sheet, in the customer list box, select a customer.</li>
<li>right click on the sheet and then select New sheet objects, button.</li>
<li>On the general tab, under text, type Show Order Details.</li>
<li>Under background, select Plain, and hten select a light grey colour.</li>
<li>On the font tab, select bold and a dark grey colour.</li>
<li>On the action tab, click add, for action type select layout, and for action, Activate Sheet. click ok.</li>
<li>Place the cursor in the SheetID field and past the id you have copied earlier.</li>
<li>On the layout tab, under show, select conditional and then type Count(CompanyName) = 1 click ok.</li>
<li>Place the button below the customer details table.</li>
</ul>
<p><img src="./img/14.png" alt=""></p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="03">
        <h1>Conditional Calculation</h1>
<p>The order details table box contains many rows. In order to optimise performance you are going to define a calculation condition. It is very unlikely that your user wants to show OrderDetails for more than ten customers at a time, you can set the condition to only perform the calculation for the Order Details table box if hte user has selected between 1 and 10 customers. It is important to inform the user of this condition.</p>
<ul>
<li>On the order details sheet open the Order details property box, on the general tab, under calculation condition type =Count(CompanyName) &lt;10</li>
<li>click the error message button, under standard messages, select calculation condition unfulfilled and in the custom message field, type Select between 1 and 10 customers to show the table. click ok and ok again.</li>
</ul>
<p><img src="./img/15.png" alt=""></p>
<p>Select a customer and the table appears.</p>

      </div>
     
      <div  class="ui tab segment lab" data-tab="04">
        <h1>Icons to the tarffic light gauge</h1>
<p>Create a visualisation that indicates if CYTD Sales are higher or lower than LYTD sales.</p>
<p>To do this we use a variable. Variables are often used to enforce consistency of measures especially for KPI&#39;s so that all applications use the same formula and perhaps colour definitions for consistency.</p>
<p>-Save the variables.txt file into the same folder you have the xls files etc used by the qlikview application.</p>
<ul>
<li><p><a href="./archives/variables.txt">variables</a></p>
</li>
<li><p>Open the script editor and go to a blank line, from the insert menu choose include statement, locate the Variables.txt file and open.</p>
</li>
<li>Reload the application, click ok.</li>
<li>In the settings menu select variable overview. Here you can see a list of variables with their associated formula.</li>
</ul>
<p>Now we can create the visualisation using the variable.</p>
<p>If Sales CYTD &gt; Sales LYTD then show a green upward pointing arrow.
If Sales CYTD &lt; Sales LYTD then show a red downward pointing arrow.</p>
<ul>
<li>Create a next tex object on the Dashboard sheet.</li>
<li>On the general properties tab, under text type, =$(vKPI_Sales_CYTD_LYTD_Icon)</li>
<li>Under layout, select left for horizontal alignment and top for vertical.</li>
<li>under background, set the slider for Transparency 100%.</li>
<li>on the font tab select bold and size 18</li>
<li>Click the colour tile and under base colour set it to be calculated and type $(vKPI_Sales_CYTD_LYTD_Color)</li>
<li>click ok and ok again. Place the arrow to the right of the Sales CYTD KPI text object.</li>
</ul>
<p><img src="./img/16.png" alt=""></p>
<p>You can apply the same calculation to the colour of the text object so that the dollar figure also shows in Green.</p>

      </div>
     
    </div>
  </div>
</div>
<!--<div class="ui bottom fixed borderless right menu">
  <div class="ui right tiny menu">
    <div class="ui mini message segment">
      .
      <a href="http://creativecommons.org/licenses/by-nc/4.0/"
         title="External link to http://creativecommons.org/licenses/by-nc/4.0/"
         target="_blank">Creative Commons License
      </a>
    </div>
  </div>
</div>-->

<script>
  $(document).on('keydown', function(e) {
  e = e || window.event;
  var nextTab;
  switch (e.which || e.keyCode) {
    case 37: // left
      nextTab = $('.tab-menu a[data-tab].active').prev('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').last();
      nextTab.click();
      $('.pusher').focus();
      break;

    case 39: // right
      nextTab = $('.tab-menu a[data-tab].active').next('a[data-tab]');
      if (!nextTab.length) nextTab = $('.tab-menu a[data-tab]').first();
      nextTab.click();
      $('.pusher').focus();
      break;
  }
});

</script>



    <footer>

    </footer>
    <script>
      $(document).ready(function() {
  $('img').addClass('ui image');

  $('.ui.embed').embed();

  const $images = $('.lab img');
  jQuery.each($images, function(i) {
    if ($images[i].alt.length > 0) {
      const divImg = $(document.createElement('div')).addClass(
        'ui basic segment',
      );
      $($images[i]).wrap(divImg);
      const divLabel = $(document.createElement('div')).addClass(
        'ui blue ribbon label',
      );
      divLabel.append($images[i].alt);
      $(divLabel).insertBefore($images[i]);
    }
  });

  $('.ui.menu .item').tab({
    history: true,
    historyType: 'hash',
  });

  $('.popup').popup();

  $('.ui.sidebar')
    .sidebar({ context: $('.pushable') })
    .sidebar('setting', 'transition', 'slide out')
    .sidebar('attach events', '#toc');
});

    </script>
  </body>

 </html>